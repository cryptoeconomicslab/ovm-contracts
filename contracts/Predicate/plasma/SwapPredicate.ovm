def swap(maker, c_token, c_amount, min_block_number, max_block_number, tx) := 
  with Range(min_block_number, max_block_number) as b {
    with SU(b, c_token) as c_su {
      Equal(c_su.address, $swapAddress)
      and IsSameAmount(c_su.1, c_amount)
      and Equal(c_su.3.1, maker)
      and (
        Withdraw(c_su)
        or with Tx(c_su.0, c_su.1, c_su.2) as tx {
          IsValidSignature(tx, maker)
        }
      )
      and IsValidSignature(tx, c_su.3.0)
    }
  }
